# GO502A37: Relatorio de Transacoes Suspensas e Ocorrencias de Conta Corrente

## Overview

O programa GO502A37 e responsavel por gerar relatorios detalhados sobre transacoes suspensas e ocorrencias no sistema de conta corrente do Banco Volkswagen. O programa processa registros de transacoes suspensas, classificando-as por status e tipo de operacao, gerando saidas em multiplos formatos incluindo relatorios impressos, arquivos para sistema SAP e dados para sistema Corporate. O programa tambem calcula totalizadores por filial e geral, alem de gerar legendas explicativas dos codigos utilizados.

O arquivo atua como um processador central de conciliacao bancaria, integrando dados de diferentes tabelas do sistema para fornecer uma visao consolidada das transacoes pendentes, regularizadas, baixadas e transferidas, permitindo controle e auditoria das operacoes financeiras.

<!-- general-rule-start -->
## Business Rules

O programa implementa as seguintes regras de negocio para processamento de transacoes suspensas:

**Selecao de Registros**: O sistema busca transacoes da tabela PAKF023VSUSPENSO onde a data de processamento da suspensao ou data de regularizacao seja igual a data de processamento atual, ou onde o status da transacao seja diferente de 1 (pendente) e 6 (cancelado), e a situacao seja diferente de 'C' (cancelado).

**Classificacao por Status**: As transacoes sao classificadas conforme o campo ATSFSTATUS: Status 1 = Pendente, Status 2 = Baixa, Status 3 = Regularizado, Status 4 = Residuo, Status 5 = Registro Contabil. Para cada status, o sistema aplica regras especificas de contabilizacao e totalizacao.

**Separacao Debito/Credito**: O sistema determina se uma transacao e debito ou credito baseado no codigo de lancamento (FKNICODLANC). Se o codigo estiver entre 999 e 2000, a transacao e classificada como debito, caso contrario como credito. Esta classificacao afeta os totalizadores e as contas contabeis utilizadas.

**Calculo de Saldos**: O sistema calcula saldo anterior subtraindo do saldo atual as inclusoes, transferencias, baixas, exclusoes e registros contabeis do dia. O saldo da conta e calculado como a diferenca entre creditos e debitos atuais.

**Integracao SAP**: Para cada tipo de transacao, o sistema gera lancamentos contabeis para o SAP utilizando contas especificas: Codigo 3412 para baixas e exclusoes, Codigo 3413 para registros contabeis, Codigo 4412 para inclusoes e transferencias. Cada lancamento gera um par debito/credito com as contas correspondentes.

**Controle de Absorcao**: O sistema verifica na tabela PAKF074VABSORCAO se existe processo de absorcao ativo para a transacao suspensa. Se existir, a descricao da transacao e alterada para "ABSORCAO".

**Agrupamento por Filial**: Os relatorios sao organizados por filial, gerando subtotais para cada filial antes de processar a proxima. Quando ha mudanca de filial, o sistema imprime o resumo da filial anterior e reinicia os contadores.

**Validacao de Campos Nulos**: O sistema trata campos nulos (valores negativos retornados pelo banco) convertendo-os para zeros ou espacos conforme apropriado, garantindo integridade dos dados processados.

**Geracao de Legendas**: Ao final do processamento, o sistema gera legendas explicativas consultando a tabela PAKG002VTIPO, mostrando os codigos de motivo e suas descricoes correspondentes.

**Controle de Paginacao**: O relatorio controla quebras de pagina automaticamente, imprimindo cabecalhos a cada 55 linhas e numerando as paginas sequencialmente.
<!-- general-rule-end -->
## Dependencies

O programa GO502A37 possui diversas dependencias criticas que devem ser consideradas durante o processo de modernizacao. As principais dependencias incluem tabelas de banco de dados DB2, programas utilitarios COBOL, copybooks de estruturas de dados e bibliotecas de funcoes de sistema.

| Dependency | Description | Type | Reference | Relevance for Modernization |
|------------|-------------|------|-----------|----------------------------|
| PAKF023VSUSPENSO | Tabela principal de transacoes suspensas contendo dados de contratos, valores, datas e status | Database Table | AXG1000.PAKF023VSUSPENSO | CRITICA - Estrutura central do sistema, requer mapeamento completo para nova arquitetura |
| PAKF018VCONTROLE | Tabela de controle de processamento com data de processamento atual | Database Table | AXG1000.PAKF018VCONTROLE | ALTA - Controla fluxo de processamento, essencial para logica de negocio |
| PAKF008VCONTRATO | Tabela de contratos com dados de clientes e operacoes | Database Table | AXG1000.PAKF008VCONTRATO | ALTA - Dados mestres de contratos, fundamental para integridade referencial |
| PAKF005VCONLOJ | Tabela de concessionarias e filiais | Database Table | AXG1000.PAKF005VCONLOJ | MEDIA - Dados organizacionais, necessario para agrupamentos |
| PAKF074VABSORCAO | Tabela de processos de absorcao de transacoes | Database Table | AXG1000.PAKF074VABSORCAO | MEDIA - Regra especifica de negocio para tratamento de absorcoes |
| PAKG111VLANCTOCON | Tabela de configuracao de lancamentos contabeis | Database Table | AXG0201.PAKG111VLANCTOCON | ALTA - Parametrizacao contabil, essencial para integracao SAP |
| PAKG002VTIPO | Tabela de tipos e descricoes de motivos | Database Table | AXG0201.PAKG002VTIPO | BAIXA - Dados de apoio para legendas e descricoes |
| YY035A | Programa utilitario para controle de arquivos de saida | External Program | YY035A | MEDIA - Funcionalidade de sistema, pode ser substituida por APIs modernas |
| YY115A | Programa utilitario para obtencao de data e hora do sistema | External Program | YY115A | BAIXA - Funcionalidade basica, facilmente substituivel |
| GN111V00 | Copybook com estrutura da tabela PAKG111VLANCTOCON | COBOL Copybook | INCLUDE GN111V00 | ALTA - Estrutura de dados critica, requer conversao para modelo de dados moderno |
| GN002V00 | Copybook com estrutura da tabela PAKG002VTIPO | COBOL Copybook | INCLUDE GN002V00 | BAIXA - Estrutura simples, facil conversao |
| GO018V00 | Copybook com estrutura da tabela PAKF018VCONTROLE | COBOL Copybook | INCLUDE GO018V00 | ALTA - Estrutura de controle, essencial para logica |
| GO008V00 | Copybook com estrutura da tabela PAKF008VCONTRATO | COBOL Copybook | INCLUDE GO008V00 | ALTA - Estrutura complexa de contratos, requer analise detalhada |
| GO023V00 | Copybook com estrutura da tabela PAKF023VSUSPENSO | COBOL Copybook | INCLUDE GO023V00 | CRITICA - Estrutura principal, base para todo processamento |
| GO005V00 | Copybook com estrutura da tabela PAKF005VCONLOJ | COBOL Copybook | INCLUDE GO005V00 | MEDIA - Estrutura organizacional, importante para hierarquias |
| DB2 Database | Sistema gerenciador de banco de dados IBM DB2 | Database System | IBM DB2 | CRITICA - Toda persistencia de dados, requer estrategia de migracao |
| SQLCA | Area de comunicacao SQL para controle de erros | SQL Component | EXEC SQL INCLUDE SQLCA | ALTA - Controle de transacoes, deve ser adaptado para novo SGBD |
## Detailed Rules

<!-- rule-start -->
**1. Rule: Inicializacao do Sistema e Controle de Data de Processamento**
- **Function/Method Name:** R010INICIALIZA
- **Detailed Description of the Rule:** Esta regra inicializa o sistema, obtem a data atual, determina a data de processamento das transacoes suspensas e configura as contas contabeis para diferentes tipos de operacao
- **What it proposes to do:** Preparar o ambiente de processamento e definir parametros de controle
- **Rule Status:** Relevant for Modernization
- **Algorithm:**
  1. Abrir todos os arquivos de saida (AD1GO002, AB1GO002, AB2GO002, AB3GO002)
  2. Chamar funcao YY115A para obter data e hora atual do sistema
  3. Extrair dia, mes, ano, hora e minuto da data retornada
  4. Executar consulta SQL: SELECT MIN(PKDTDTPROC) FROM AXG1000.PAKF018VCONTROLE WHERE ATSFMOVPROC <> 'N'
  5. Se SQLCODE diferente de zero OU resultado menor que zero, exibir erro e cancelar processamento
  6. Converter data obtida para formato dia/mes/ano e armazenar nos titulos do relatorio
  7. Inicializar todas as variaveis de totalizacao com zero
  8. Para cada codigo SAP (3412, 3413, 4412):
     - Definir WS06CONVCOMPLEMENTO = codigo SAP
     - Chamar rotina R069ACESSACONTA para obter contas debito e credito
     - Armazenar contas nas variaveis correspondentes (WSCTDEBITO/WSCTCREDITO + codigo)
  9. Executar COMMIT para confirmar transacao
<!-- rule-end -->

<!-- rule-start -->
**2. Rule: Processamento Principal de Transacoes Suspensas**
- **Function/Method Name:** R020PROCESSA
- **Detailed Description of the Rule:** Esta regra processa cada registro de transacao suspensa, aplicando logica de classificacao por status e calculando totalizadores
- **What it proposes to do:** Processar individualmente cada transacao e aplicar regras de negocio especificas
- **Rule Status:** Relevant for Modernization
- **Algorithm:**
  1. Executar FETCH no cursor REGISTRO para obter proximo registro
  2. Se SQLCODE = 100 (fim de arquivo):
     - Fechar cursor REGISTRO
     - Definir CHAVEFIM = HIGH-VALUES para encerrar loop principal
     - Sair da rotina
  3. Se SQLCODE diferente de zero, exibir erro e cancelar
  4. Se ATNICODSAP >= 4400, pular registro (ir para fim da rotina)
  5. Incrementar contador CTLIDOS em 1
  6. Chamar R025VERIFICACAMPOS para validar campos nulos
  7. Se ATNICODSAP > 0, chamar R094SELECTLANCTOCON para obter descricao
  8. Chamar R095ACESSATIPO para obter descricao do tipo
  9. Verificar mudanca de filial:
     - Se WSFILIALANT diferente de FKNDFILIAL atual:
       - Imprimir resumo da filial anterior
       - Definir CTLIN = 70 para forcar nova pagina
       - Atualizar WSFILIALANT com filial atual
  10. Aplicar logica de processamento baseada em datas e status (ver regras especificas)
<!-- rule-end -->

<!-- rule-start -->
**3. Rule: Classificacao de Transacoes por Data e Status**
- **Function/Method Name:** Logica dentro de R020PROCESSA
- **Detailed Description of the Rule:** Esta regra classifica transacoes em diferentes categorias baseadas na data de processamento e status, aplicando calculos especificos para cada tipo
- **What it proposes to do:** Determinar o tipo de operacao e aplicar calculos de totalizacao apropriados
- **Rule Status:** Relevant for Modernization
- **Algorithm:**
  1. **Transacoes Pendentes (ATDTPROCSUSP <> PKDTDTPROC E WSATSFSTATUS = 1):**
     - Definir descricao = "PENDENTE"
     - Somar 1 ao contador WSQTDESALDOATU
     - Se FKNICODLANC entre 999 e 2000: somar ATNDVALORCR a WSVLRDEBATU
     - Senao: somar ATNDVALORCR a WSVLRCREDATU
     - Sair da rotina

  2. **Inclusoes do Dia (ATDTPROCSUSP = PKDTDTPROC E WSATSFSTATUS = 1):**
     - Se WSATNISUSPENSOANTNN <= 1:
       - Somar 1 a WSQTDEINCLU
       - Definir descricao = "INCLUIDO DIA E PENDENTE"
     - Senao:
       - Somar 1 a WSQTDETRANS
       - Definir descricao = "INCL.TRANSF. PENDENTE"
     - Chamar R030IMPRIMEDET para imprimir detalhes
     - Somar 1 a WSQTDESALDOATU
     - Aplicar mesma logica de debito/credito do item 1

  3. **Inclusoes com Regularizacao no Mesmo Dia:**
     - Se ATDTPROCSUSP = PKDTDTPROC E ATDTREGULAR = PKDTDTPROC E WSATSFSTATUS <> 1:
       - Chamar R037VERIFABSORCAO para verificar absorcao
       - Se existe absorcao: definir descricao = "ABSORCAO"
       - Senao: usar descricao do lancamento
       - Definir descricao1 = "INCLUIDO DIA"
       - Imprimir detalhes duas vezes (inclusao e regularizacao)
       - Aplicar calculos baseados no status final

  4. **Regularizacoes de Dias Anteriores:**
     - Se ATDTREGULAR = PKDTDTPROC E WSATSFSTATUS <> 1:
       - Chamar R050VESTATUS para definir descricao do status
       - Imprimir detalhes
       - Aplicar calculos baseados no status
<!-- rule-end -->

<!-- rule-start -->
**4. Rule: Calculo de Totalizadores por Status**
- **Function/Method Name:** Logica de totalizacao em R020PROCESSA
- **Detailed Description of the Rule:** Esta regra aplica calculos matematicos especificos baseados no status da transacao e codigo de lancamento
- **What it proposes to do:** Calcular valores de debito, credito e quantidades para diferentes tipos de operacao
- **Rule Status:** Relevant for Modernization
- **Algorithm:**
  1. **Determinacao Debito/Credito:**
     - Se FKNICODLANC >= 999 E FKNICODLANC <= 2000: transacao = DEBITO
     - Senao: transacao = CREDITO

  2. **Calculos por Status - DEBITO:**
     - Status 2 (Baixa): WSVLRDEBBAIXA += ATNDVALORCR; WSQTDEBAIXA += 1
     - Status 5 (Reg.Contabil): WSVLRDEBREGCTB += ATNDVALORCR; WSQTDEREGCTB += 1; WSQTDE1REGCTB += 1
     - Outros status: WSVLRDEBEXCL += ATNDVALORCR; WSQTDEEXCL += 1

  3. **Calculos por Status - CREDITO:**
     - Status 2 (Baixa): WSVLRCREDBAIXA += ATNDVALORCR; WSQTDEBAIXA += 1
     - Status 5 (Reg.Contabil): WSVLRCREDREGCTB += ATNDVALORCR; WSQTDEREGCTB += 1; WSQTDE1REGCTB += 1
     - Outros status: WSVLRCREDEXCL += ATNDVALORCR; WSQTDEEXCL += 1

  4. **Calculos para Inclusoes:**
     - Se WSATNISUSPENSOANTNN <= 1:
       - DEBITO: WSVLRDEBINCLU += ATNDVALORCR
       - CREDITO: WSVLRCREDINCLU += ATNDVALORCR
     - Senao:
       - DEBITO: WSVLRDEBTRANS += ATNDVALORCR
       - CREDITO: WSVLRCREDTRANS += ATNDVALORCR
<!-- rule-end -->

<!-- rule-start -->
**5. Rule: Calculo de Saldos e Totais por Filial**
- **Function/Method Name:** R060IMPRIMERESUMO
- **Detailed Description of the Rule:** Esta regra calcula saldos anteriores, atuais e da conta, alem de consolidar totais por filial
- **What it proposes to do:** Gerar resumo financeiro completo da filial com todos os calculos de saldo
- **Rule Status:** Relevant for Modernization
- **Algorithm:**
  1. **Calculo do Saldo Anterior:**
     - WSQTDESALDOANT = WSQTDESALDOATU - WSQTDEINCLU - WSQTDETRANS - WSQTDEBAIXA - WSQTDEEXCL - WSQTDEREGCTB
     - WSVLRDEBANT = WSVLRDEBATU - WSVLRDEBINCLU - WSVLRDEBTRANS - WSVLRDEBBAIXA - WSVLRDEBEXCL - WSVLRDEBREGCTB
     - WSVLRCREDANT = WSVLRCREDATU - WSVLRCREDINCLU - WSVLRCREDTRANS - WSVLRCREDBAIXA - WSVLRCREDEXCL - WSVLRCREDREGCTB

  2. **Calculo do Saldo da Conta:**
     - WSSALDOCONTA = WSVLRCREDATU - WSVLRDEBATU

  3. **Acumulacao nos Totais Gerais:**
     - WSTOTQTDSDANT += WSQTDESALDOANT
     - WSTOTDEBANT += WSVLRDEBANT
     - WSTOTCREDANT += WSVLRCREDANT
     - WSTOTQTDINCLU += WSQTDEINCLU
     - WSTOTDEBINCLU += WSVLRDEBINCLU
     - WSTOTCREDINCLU += WSVLRCREDINCLU
     - WSTOTQTDTRANS += WSQTDETRANS
     - WSTOTDEBTRANS += WSVLRDEBTRANS
     - WSTOTCREDTRANS += WSVLRCREDTRANS
     - WSTOTQTDBAIXA += WSQTDEBAIXA
     - WSTOTDEBBAIXA += WSVLRDEBBAIXA
     - WSTOTCREDBAIXA += WSVLRCREDBAIXA
     - WSTOTQTDEXCL += WSQTDEEXCL
     - WSTOTDEBEXCL += WSVLRDEBEXCL
     - WSTOTCREDEXCL += WSVLRCREDEXCL
     - WSTOTQTDREGCTB += WSQTDEREGCTB
     - WSTOTDEBREGCTB += WSVLRDEBREGCTB
     - WSTOTCREDREGCTB += WSVLRCREDREGCTB
     - WSTOTQTDSDATU += WSQTDESALDOATU
     - WSTOTDEBATU += WSVLRDEBATU
     - WSTOTCREDATU += WSVLRCREDATU
     - WSTOTSALDOCONTA += WSSALDOCONTA

  4. **Zeragem dos Totais da Filial:**
     - Inicializar estrutura WSTOTAIS com zeros para proxima filial
<!-- rule-end -->

<!-- rule-start -->
**6. Rule: Geracao de Lancamentos SAP**
- **Function/Method Name:** R065IMPRIMETOTGER e R067GRAVASAP
- **Detailed Description of the Rule:** Esta regra gera lancamentos contabeis para integracao com sistema SAP baseados nos totais calculados
- **What it proposes to do:** Criar registros de debito e credito para cada tipo de operacao no formato SAP
- **Rule Status:** Relevant for Modernization
- **Algorithm:**
  1. **Calculo de Totais para SAP:**
     - WSTOTALCREDI = WSTOTCREDINCLU + WSTOTCREDTRANS (inclusoes e transferencias)
     - WSTOTALCREDB = WSTOTCREDBAIXA + WSTOTCREDEXCL (baixas e exclusoes)

  2. **Geracao de Lancamento para Inclusoes/Transferencias (se WSTOTALCREDI > 0):**
     - Codigo SAP = 4412
     - Conta Debito = WSCTDEBITO4412
     - Conta Credito = WSCTCREDITO4412
     - Valor = WSTOTALCREDI
     - Chamar R067GRAVASAP

  3. **Geracao de Lancamento para Baixas/Exclusoes (se WSTOTALCREDB > 0):**
     - Codigo SAP = 3412
     - Conta Debito = WSCTDEBITO3412
     - Conta Credito = WSCTCREDITO3412
     - Valor = WSTOTALCREDB
     - Chamar R067GRAVASAP

  4. **Geracao de Lancamento para Registros Contabeis (se WSTOTCREDREGCTB > 0):**
     - Codigo SAP = 3413
     - Conta Debito = WSCTDEBITO3413
     - Conta Credito = WSCTCREDITO3413
     - Valor = WSTOTCREDREGCTB
     - Chamar R067GRAVASAP

  5. **Estrutura do Registro SAP (R067GRAVASAP):**
     - WS012CORPORA = "E04"
     - WS012DIA = dia da data de processamento
     - WS012MES = mes da data de processamento
     - WS012ANO = ano da data de processamento (2 digitos)
     - WS012FIL = 00
     - WS012EVENTO = "GO002A"
     - WS012DTREF = data completa de processamento
     - WS012VALOR = valor calculado
     - WS012TDOC = "GO"
     - Para cada lancamento, gerar 2 registros:
       - Registro DEBITO: WS012DC = "D", WS012CONTA = conta debito
       - Registro CREDITO: WS012DC = "C", WS012CONTA = conta credito
     - Se codigo <> 4412: WS012CL = " ", centros em branco
     - Senao: WS012CL = "L", WS012CENTRO1 = "130", WS012CENTRO2 = "100"
<!-- rule-end -->

<!-- rule-start -->
**7. Rule: Geracao de Registros Corporate**
- **Function/Method Name:** R035GRAVARCORPORATE
- **Detailed Description of the Rule:** Esta regra gera registros para sistema Corporate com dados detalhados de cada transacao
- **What it proposes to do:** Criar registro padronizado para integracao com sistema Corporate
- **Rule Status:** Relevant for Modernization
- **Algorithm:**
  1. **Inicializacao 
Data Structure

Esta secao descreve as estruturas de dados utilizadas pelo programa GO502A37, incluindo registros de entrada, saida e variaveis de trabalho essenciais para o processamento de transacoes suspensas.

| Field ID | Field Name | Data Type | Field Size | Description | Mandatory | Default Value | Additional Notes | Relevant for Modernization | Information Type |
|----------|------------|-----------|------------|-------------|-----------|---------------|------------------|---------------------------|------------------|
| PAKF023-01 | PKNISUSPENSO | Numeric | 9 | Numero sequencial unico da transacao suspensa | Sim | - | Chave primaria da tabela | CRITICA | Primary Key |
| PAKF023-02 | FKNICONTRATO | Numeric | 9 | Numero do contrato associado a transacao | Sim | - | Chave estrangeira para PAKF008VCONTRATO | ALTA | Foreign Key |
| PAKF023-03 | FKNIDOCUMENTO | Numeric | 9 | Numero do documento da transacao | Nao | 0 | Pode ser nulo | MEDIA | Business Data |
| PAKF023-04 | ATNDVALORCR | Decimal | 15,2 | Valor da transacao em reais | Sim | - | Valor monetario com 2 decimais | CRITICA | Financial Data |
| PAKF023-05 | ATDTPAGTO | Date | 10 | Data de pagamento da transacao | Nao | SPACES | Formato AAAA-MM-DD | ALTA | Date Field |
| PAKF023-06 | ATDTDTCRED | Date | 10 | Data de credito da transacao | Nao | SPACES | Formato AAAA-MM-DD | ALTA | Date Field |
| PAKF023-07 | ATDTPROCSUSP | Date | 10 | Data de processamento da suspensao | Sim | - | Data de inclusao do registro | CRITICA | Date Field |
| PAKF023-08 | FKNDBANCO | Numeric | 3 | Codigo do banco | Nao | 0 | Codigo numerico do banco | MEDIA | Reference Data |
| PAKF023-09 | FKNICODLANC | Numeric | 4 | Codigo do tipo de lancamento | Sim | - | Define se e debito ou credito | CRITICA | Business Rule |
| PAKF023-10 | ATNIMOTIVO | Numeric | 4 | Codigo do motivo da suspensao | Sim | - | Referencia para PAKG002VTIPO | ALTA | Reference Data |
| PAKF023-11 | ATSFSTATUS | Character | 1 | Status atual da transacao | Sim | - | 1=Pendente, 2=Baixa, 3=Regularizado, 4=Residuo, 5=RegContabil | CRITICA | Status Field |
| PAKF023-12 | ATSFSITUACAO | Character | 1 | Situacao da transacao | Sim | - | Controla se transacao esta ativa | ALTA | Status Field |
| PAKF023-13 | ATNICODSAP | Numeric | 4 | Codigo SAP da transacao | Nao | 0 | Usado para integracao SAP | ALTA | Integration Data |
| PAKF023-14 | ATSFUSERID | Character | 8 | Usuario que processou a transacao | Nao | SPACES | Auditoria de usuario | MEDIA | Audit Data |
| PAKF023-15 | ATSFPROGRAMA | Character | 8 | Programa que gerou a transacao | Nao | SPACES | Auditoria de sistema | BAIXA | Audit Data |
| PAKF023-16 | ATNICODSAPANT | Numeric | 4 | Codigo SAP anterior | Nao | 0 | Historico de alteracoes SAP | MEDIA | Historical Data |
| PAKF023-17 | ATSFNOSSONUM | Character | 12 | Nosso numero do banco | Nao | SPACES | Identificacao bancaria | MEDIA | Banking Data |
| PAKF023-18 | ATNDBANCOARREC | Numeric | 3 | Banco arrecadador | Nao | 0 | Banco que processou pagamento | MEDIA | Banking Data |
| PAKF023-19 | ATNDAGENCIA | Numeric | 5 | Agencia arrecadadora | Nao | 0 | Agencia que processou pagamento | MEDIA | Banking Data |
| PAKF023-20 | ATSFFORMAPAGTO | Character | 8 | Forma de pagamento | Nao | SPACES | Tipo de pagamento utilizado | MEDIA | Business Data |
| PAKF023-21 | ATNISUSPENSOANT | Numeric | 9 | Numero da suspensao anterior | Nao | 0 | Controle de transferencias | ALTA | Control Data |
| PAKF023-22 | ATDTREGULAR | Date | 10 | Data de regularizacao | Nao | SPACES | Data de resolucao da suspensao | ALTA | Date Field |
| PAKF008-01 | FKNDCPFCGC | Numeric | 15 | CPF ou CNPJ do cliente | Sim | - | Documento do cliente | ALTA | Personal Data |
| PAKF008-02 | FKSFTIPOCLI | Character | 1 | Tipo de cliente | Sim | - | F=Fisica, J=Juridica | ALTA | Classification |
| PAKF008-03 | ATNISTOPER | Numeric | 4 | Status da operacao do contrato | Nao | 0 | Status operacional | MEDIA | Status Field |
| PAKF008-04 | ATDTSTOPER | Date | 10 | Data do status da operacao | Nao | SPACES | Data da ultima alteracao status | MEDIA | Date Field |
| PAKF008-05 | ATSFTIPOFIN | Character | 3 | Tipo de financiamento | Nao | SPACES | Categoria do financiamento | MEDIA | Classification |
| PAKF008-06 | ATSFTPOPER | Character | 3 | Tipo de operacao | Nao | SPACES | Categoria da operacao | MEDIA | Classification |
| PAKF008-07 | ATSVNOMECLI | Character | 60 | Nome do cliente | Nao | SPACES | Nome completo ou razao social | ALTA | Personal Data |
| PAKF005-01 | FKNDFILIAL | Numeric | 3 | Codigo da filial | Sim | - | Identificacao da filial | ALTA | Organizational |
| PAKF018-01 | PKDTDTPROC | Date | 10 | Data de processamento atual | Sim | - | Data de referencia do processamento | CRITICA | Control Data |
| WS-TOT-01 | WSQTDESALDOANT | Numeric | 9 | Quantidade saldo anterior | Nao | 0 | Contador de transacoes saldo anterior | ALTA | Calculated Field |
| WS-TOT-02 | WSVLRDEBANT | Decimal | 15,2 | Valor debito anterior | Nao | 0 | Soma valores debito saldo anterior | ALTA | Calculated Field |
| WS-TOT-03 | WSVLRCREDANT | Decimal | 15,2 | Valor credito anterior | Nao | 0 | Soma valores credito saldo anterior | ALTA | Calculated Field |
| WS-TOT-04 | WSQTDESALDOATU | Numeric | 9 | Quantidade saldo atual | Nao | 0 | Contador de transacoes saldo atual | ALTA | Calculated Field |
| WS-TOT-05 | WSVLRDEBATU | Decimal | 15,2 | Valor debito atual | Nao | 0 | Soma valores debito saldo atual | ALTA | Calculated Field |
| WS-TOT-06 | WSVLRCREDATU | Decimal | 15,2 | Valor credito atual | Nao | 0 | Soma valores credito saldo atual | ALTA | Calculated Field |
| WS-TOT-07 | WSQTDEINCLU | Numeric | 9 | Quantidade inclusoes | Nao | 0 | Contador de inclusoes do dia | ALTA | Calculated Field |
| WS-TOT-08 | WSVLRDEBINCLU | Decimal | 15,2 | Valor debito inclusoes | Nao | 0 | Soma valores debito inclusoes | ALTA | Calculated Field |
| WS-TOT-09 | WSVLRCREDINCLU | Decimal | 15,2 | Valor credito inclusoes | Nao | 0 | Soma valores credito inclusoes | ALTA | Calculated Field |
| WS-TOT-10 | WSQTDETRANS | Numeric | 9 | Quantidade transferencias | Nao | 0 | Contador de transferencias | ALTA | Calculated Field |
| WS-TOT-11 | WSVLRDEBTRANS | Decimal | 15,2 | Valor debito transferencias | Nao | 0 | Soma valores debito transferencias | ALTA | Calculated Field |
| WS-TOT-12 | WSVLRCREDTRANS | Decimal | 15,2 | Valor credito transferencias | Nao | 0 | Soma valores credito transferencias | ALTA | Calculated Field |
| WS-TOT-13 | WSQTDEBAIXA | Numeric | 9 | Quantidade baixas | Nao | 0 | Contador de baixas do dia | ALTA | Calculated Field |
| WS-TOT-14 | WSVLRDEBBAIXA | Decimal | 15,2 | Valor debito baixas | Nao | 0 | Soma valores debito baixas | ALTA | Calculated Field |
| WS-TOT-15 | WSVLRCREDBAIXA | Decimal | 15,2 | Valor credito baixas | Nao | 0 | Soma valores credito baixas | ALTA | Calculated Field |
| WS-TOT-16 | WSQTDEEXCL | Numeric | 9 | Quantidade exclusoes | Nao | 0 | Contador de exclusoes regularizacoes | ALTA | Calculated Field |
| WS-TOT-17 | WSVLRDEBEXCL | Decimal | 15,2 | Valor debito exclusoes | Nao | 0 | Soma valores debito exclusoes | ALTA | Calculated Field |
| WS-TOT-18 | WSVLRCREDEXCL | Decimal | 15,2 | Valor credito exclusoes | Nao | 0 | Soma valores credito exclusoes | ALTA | Calculated Field |
| WS-TOT-19 | WSQTDEREGCTB | Numeric | 9 | Quantidade registros contabeis | Nao | 0 | Contador registros contabeis | ALTA | Calculated Field |
| WS-TOT-20 | WSVLRDEBREGCTB | Decimal | 15,2 | Valor debito registros contabeis | Nao | 0 | Soma valores debito reg contabeis | ALTA | Calculated Field |
| WS-TOT-21 | WSVLRCREDREGCTB | Decimal | 15,2 | Valor credito registros contabeis | Nao | 0 | Soma valores credito reg contabeis | ALTA | Calculated Field |
| WS-TOT-22 | WSSALDOCONTA | Decimal | 15,2 | Saldo da conta | Nao | 0 | Diferenca entre creditos e debitos | CRITICA | Calculated Field |
| SAP-01 | WS012CORPORA | Character | 3 | Codigo corporativo SAP | Sim | E04 | Identificacao da empresa no SAP | ALTA | SAP Integration |
| SAP-02 | WS012DATA | Character | 6 | Data do lancamento SAP | Sim | - | Formato DDMMAA | ALTA | SAP Integration |
| SAP-03 | WS012CONTA | Character | 10 | Conta contabil SAP | Sim | - | Numero da conta contabil | CRITICA | SAP Integration |
| SAP-04 | WS012DC | Character | 1 | Debito ou Credito | Sim | - | D=Debito, C=Credito | CRITICA | SAP Integration |
| SAP-05 | WS012VALOR | Decimal | 13,2 | Valor do lancamento SAP | Sim | - | Valor monetario | CRITICA | SAP Integration |
| SAP-06 | WS012HISTORICO | Character | 50 | Historico do lancamento | Nao | SPACES | Descricao da operacao | MEDIA | SAP Integration |
Items Relevant for Modernization Esta secao identifica os componentes do programa GO502A37 que possuem maior relevancia para o processo de modernizacao, considerando impacto no negocio, complexidade tecnica e dependencias criticas.

**Componentes Criticos para Modernizacao**

**Logica de Negocio Principal**
- R020PROCESSA - Processamento central de transacoes com regras complexas de classificacao por status e data
- Algoritmos de calculo de saldos e totalizadores por filial com formulas matematicas especificas
- Regras de determinacao debito/credito baseadas em codigo de lancamento (999-2000)
- Logica de absorcao de transacoes com verificacao na tabela PAKF074VABSORCAO

**Integracao com Sistemas Externos**
- Geracao de lancamentos SAP com estrutura especifica de debito/credito
- Criacao de registros Corporate com mapeamento de contas contabeis
- Consultas SQL complexas com multiplas tabelas e joins
- Controle de transacoes DB2 com tratamento de erros SQLCODE

**Estruturas de Dados Complexas**
- Cursor REGISTRO com 25 campos de diferentes tabelas
- Estruturas de totalizacao WSTOTAIS e WSTOTAISGER com 22 campos cada
- Mapeamento de contas contabeis por codigo SAP (3412, 3413, 4412)
- Formatacao de registros de saida com layouts fixos

**Processamento de Arquivos**
- Geracao simultanea de 4 arquivos de saida com formatos distintos
- Controle de paginacao e quebras de pagina automaticas
- Formatacao de relatorios com cabecalhos e rodapes dinamicos
- Gravacao de registros SAP e Corporate com estruturas especificas

**Validacoes e Controles**
- Tratamento de campos nulos com conversao para zeros/espacos
- Validacao de datas e valores monetarios
- Controle de mudanca de filial com impressao de subtotais
- Verificacao de existencia de registros em tabelas relacionadas

**Calculos Financeiros**
- Formula de saldo anterior: atual - inclusoes - transferencias - baixas - exclusoes - reg.contabeis
- Calculo de saldo da conta: creditos atuais - debitos atuais
- Acumulacao de totais gerais por tipo de operacao
- Separacao de valores por status de transacao

**Dependencias de Sistema**
- Programas utilitarios YY035A e YY115A para controle de arquivos e data
- Copybooks de estruturas de dados (GN111V00, GO023V00, etc.)
- Tabelas de parametrizacao (PAKG111VLANCTOCON, PAKG002VTIPO)
- Controle de processamento via tabela PAKF018VCONTROLE

**Componentes de Menor Prioridade**
- Formatacao de legendas e descricoes de motivos
- Impressao de cabecalhos e titulos de relatorio
- Contadores de linhas e paginas
- Mensagens de erro e displays informativos

**Recomendacoes para Modernizacao**
1. Priorizar migracao da logica de negocio central (R020PROCESSA)
2. Criar APIs para substituir integracao SAP e Corporate
3. Implementar novo modelo de dados para substituir estruturas COBOL
4. Desenvolver servicos para calculos financeiros e totalizadores
5. Modernizar controle de arquivos com tecnologias de streaming
6. Substituir cursores SQL por paginacao moderna
7. Implementar cache para consultas de parametrizacao
8. Criar testes automatizados para validar calculos complexos
Items Irrelevant for Modernization Esta secao identifica os componentes do programa GO502A37 que possuem baixa relevancia para o processo de modernizacao e podem ser ignorados ou substituidos por funcionalidades modernas padrao.

Componentes de Baixa Prioridade

Formatacao de Relatorios Impressos
- Estruturas de cabecalho WCAB01, WCAB02, WCAB03 com formatacao fixa de 133 caracteres
- Controle de paginacao manual com contadores CTLIN, CTPAG, CTLINHAS
- Formatacao de detalhes WDET01, WDET02 com espacamento fixo
- Impressao de linhas em branco e separadores visuais
- Controle de quebra de pagina AFTER ADVANCING PAGE

Legendas e Descricoes Auxiliares
- Rotina R070IMPRIMELEGENDACAB para impressao de cabecalhos de legenda
- Rotina R080IMPRIMELEGENDADET para impressao de detalhes de legenda
- Estruturas WMOT01, WMOT02 para titulos de legendas
- Formatacao de codigos e descricoes em duas colunas WDETMOT
- Consulta a tabela PAKG002VTIPO apenas para exibicao

Controles de Apresentacao
- Variaveis de formatacao de data WSDATAAUX com separadores
- Estruturas de titulo WSTITULO1, WSTITULO2 com textos fixos
- Formatacao de valores monetarios com mascaras ZZZZZZZZZZZZ9,99
- Controle de espacamento e alinhamento de campos
- Definicao de caracteres de preenchimento FILLER

Mensagens e Displays
- Mensagens de erro padrao ERRO NA TABELA, ERRO NA LEITURA
- Displays informativos de inicio e fim de processamento
- Contadores de registros lidos, linhas impressas, paginas
- Mensagem de arquivo vazio WSEMMOVTO
- Displays de debug com valores de campos

Utilitarios de Sistema Obsoletos
- Programa YY035A para controle de arquivos pode ser substituido por APIs modernas
- Programa YY115A para data/hora pode ser substituido por funcoes nativas
- Estrutura GNDATUM complexa para manipulacao de datas
- Conversores de data entre formatos diferentes
- Controle manual de abertura/fechamento de arquivos

Validacoes Basicas
- Rotina R025VERIFICACAMPOS para tratar campos nulos simples
- Conversao de valores negativos para zero
- Validacao basica de SQLCODE diferente de zero
- Tratamento de espacos em campos de data
- Inicializacao de variaveis com SPACES e ZEROS

Estruturas de Trabalho Temporarias
- Variaveis auxiliares WS0, WS2, WS4, WS18, WS43 com valores constantes
- Campos de controle CHAVEFIM, WSSITUACAOANTES, WSFILIALANT
- Contadores temporarios para loops e iteracoes
- Variaveis de flag como WSEXISTE074V
- Campos de trabalho para formatacao WSDESCROBS1, WSDESCROBS2

Funcionalidades Substituiveis por Tecnologias Modernas
- Controle manual de transacoes SQL com COMMIT
- Abertura explicita de cursores com DECLARE e OPEN
- Fechamento manual de arquivos e cursores
- Tratamento de fim de arquivo com SQLCODE = 100
- Controle de retorno com RETURNCODE e GOBACK

Recomendacoes para Modernizacao
1. Substituir formatacao de relatorios por geradores modernos PDF/HTML
2. Implementar logging estruturado no lugar de displays
3. Usar bibliotecas modernas para manipulacao de data/hora
4. Aplicar validacao declarativa em modelos de dados
5. Implementar paginacao automatica em APIs REST
6. Usar frameworks de template para formatacao de saidas
7. Substituir controles manuais por gerenciamento automatico de recursos
8. Implementar tratamento de excecoes moderno no lugar de codigos de retorno
