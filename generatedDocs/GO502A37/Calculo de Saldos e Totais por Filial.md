**5. Rule: Calculo de Saldos e Totais por Filial**
- **Function/Method Name:** R060IMPRIMERESUMO
- **Detailed Description of the Rule:** Esta regra calcula saldos anteriores, atuais e da conta, alem de consolidar totais por filial
- **What it proposes to do:** Gerar resumo financeiro completo da filial com todos os calculos de saldo
- **Rule Status:** Relevant for Modernization
- **Algorithm:**
  1. **Calculo do Saldo Anterior:**
     - WSQTDESALDOANT = WSQTDESALDOATU - WSQTDEINCLU - WSQTDETRANS - WSQTDEBAIXA - WSQTDEEXCL - WSQTDEREGCTB
     - WSVLRDEBANT = WSVLRDEBATU - WSVLRDEBINCLU - WSVLRDEBTRANS - WSVLRDEBBAIXA - WSVLRDEBEXCL - WSVLRDEBREGCTB
     - WSVLRCREDANT = WSVLRCREDATU - WSVLRCREDINCLU - WSVLRCREDTRANS - WSVLRCREDBAIXA - WSVLRCREDEXCL - WSVLRCREDREGCTB

  2. **Calculo do Saldo da Conta:**
     - WSSALDOCONTA = WSVLRCREDATU - WSVLRDEBATU

  3. **Acumulacao nos Totais Gerais:**
     - WSTOTQTDSDANT += WSQTDESALDOANT
     - WSTOTDEBANT += WSVLRDEBANT
     - WSTOTCREDANT += WSVLRCREDANT
     - WSTOTQTDINCLU += WSQTDEINCLU
     - WSTOTDEBINCLU += WSVLRDEBINCLU
     - WSTOTCREDINCLU += WSVLRCREDINCLU
     - WSTOTQTDTRANS += WSQTDETRANS
     - WSTOTDEBTRANS += WSVLRDEBTRANS
     - WSTOTCREDTRANS += WSVLRCREDTRANS
     - WSTOTQTDBAIXA += WSQTDEBAIXA
     - WSTOTDEBBAIXA += WSVLRDEBBAIXA
     - WSTOTCREDBAIXA += WSVLRCREDBAIXA
     - WSTOTQTDEXCL += WSQTDEEXCL
     - WSTOTDEBEXCL += WSVLRDEBEXCL
     - WSTOTCREDEXCL += WSVLRCREDEXCL
     - WSTOTQTDREGCTB += WSQTDEREGCTB
     - WSTOTDEBREGCTB += WSVLRDEBREGCTB
     - WSTOTCREDREGCTB += WSVLRCREDREGCTB
     - WSTOTQTDSDATU += WSQTDESALDOATU
     - WSTOTDEBATU += WSVLRDEBATU
     - WSTOTCREDATU += WSVLRCREDATU
     - WSTOTSALDOCONTA += WSSALDOCONTA

  4. **Zeragem dos Totais da Filial:**
     - Inicializar estrutura WSTOTAIS com zeros para proxima filial